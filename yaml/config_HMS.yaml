EXP_ID              : 'exp_test'

#=calc_mode=#
calc_mode                           :
    #= Train/Preds =#
    Debug                           : False                 #=FIX=#
    num_Debug                       : 5                     #=FIX=#
    #= Split =#
    NFOLDS                          : 4         
    Calc_Fold                       : [0,1]
    Split_Mode                      : 'TH_folds1'          
    #= Select Data =#
    calc_stage                      : 'stage1' #'stage2
    #= select1_vote =#
    thresh_total_vote               : 8                    
    #= Data_select =#
    eeg_nan_ratio_thresh_train      : 0.5                  
    #= Label smoothing =#
    label_smoothing_ver             : "ver_2" 
    label_smoothing_n_evaluator     : 3
    label_smoothing_k               : 10
    label_smoothing_epsilon         : 0.05

#=dataset=#
dataset:
    input_type                  : 'EEG_WAVE'            #=change# #'EEG_WAVE' or 'EEG_IMG' or 'EEG_FFT' or 'SPEC' or 'EEG_WAVE_SPEC' or 'EEG_IMG_SPEC'
    data_read_mode              : 'load'           #=FIX=#    #'save' or 'load' or 'def' or 'pass'
    select_data_epoch           : True             #=FIX=# 
    select_data                 : 'patient_id_eeg_id'  #=new=#  #'patient_id_eeg_id'  #'patient_id_spec_id' #'patient_id_spec_id' or 'use_alldata' or 'patient_id_spec_id_overlap_spec'
    col_labels                  : ['seizure_vote','lpd_vote','gpd_vote','lrda_vote','grda_vote','other_vote']   #=FIX=# 
    #=SPEC=#
    SPEC                        :
        in_chans_spec           : 4                 
        in_chans_spec_2         : 1                 
        out_chans_spec          : 6                 
        sr_spec                 : 0.5               
        img_size_spec           : [-1,-1]           
        augmentation            :                   
            prob                    : 0.5           
            stop_aug_epoch          : 999999        #=new=#
            #pretrain
            prob_pretrain           : 0.5           #=new=#
            stop_aug_epoch_pretrain : 999999        #=new=#
            #
            aug_type            : 'time_freq_drop_HorizontalFlip' #=検討=#    #'time_freq_drop'　'time_freq_drop_HorizontalFlip''tf_drop_HFlip_blur' #=new=# 
            #time_freq_drop
            time_drop_width     : 32                #=一旦FIX=# 
            time_stripes_num    : 2                 #=一旦FIX=#
            freq_drop_width     : 4                 #=一旦FIX=#
            freq_stripes_num    : 2                 #=一旦FIX=#
            #other
            random_crop         : True              #=FIX=#
            random_channel      : 'random_in_range' #=FIX=#
            random_channel_range: [[0,1], [2,3]]    #=FIX=#
        mixup                   :
            prob                : 0.5               #=一旦FIX=# 
            alpha               : 1.0               #=一旦FIX=# 
            stop_mixup_epoch    : 999999            #=new=#
            #pretrain
            prob_pretrain       : 0.5               #=new=#
            alpha_pretrain      : 1.0               #=new=#
            stop_mixup_epoch_pretrain: 999999       #=new=#
        time_cutmix             :
            prob                : 0.25              #=一旦FIX=#
            alpha               : 1.0               #=一旦FIX=# 
            stop_cutmix_epoch   : 999999            #=new=#
            #pretrain
            prob_pretrain       : 0.25              #=new=#
            alpha_pretrain      : 1.0               #=new=#
            stop_mixup_epoch_pretrain: 999999       #=new=#
    #=EEG=#
    EEG                         :
        dataset_mode            : 'calc'            #=FIX=#     #'load','calc','pass','save'
        wave_select             : 'delta'       #=FIX=#    #'raw' or 'delta' or 'delta_8ch' or 'delta_24ch'  or 'delta_raw'
        wave_select_wave        : 'delta'      #=FIX=#    #'raw' or 'delta' or 'delta_8ch' or 'delta_24ch'  or 'delta_raw'
        wave_select_img         : 'delta'      #=FIX=#    #'raw' or 'delta' or 'delta_8ch' or 'delta_24ch'  or 'delta_raw'
        in_chans_eeg_wave       : 16                #=FIX=#
        in_chans_eeg_img        : 16                #=FIX=#
        out_chans_eeg           : 6                 #=FIX=#
        sr_eeg_org              : 200               #[Hz] 0.005#[s]
        sr_eeg_resample         : 200               #[Hz] 0.005#[s] 
        select_time2_wave       :
            calc_select_time2_wave : True           
            use_time_ave_wave      : True
            weights_time_wave      : [0.05,0.2,0.5,0.2,0.05]             
        augmentation            : 
            prob                    : 0.5            #=FIX=#
            stop_aug_epoch          : 999999        #=new=#
            #pretrain
            prob_pretrain           : 0.5           #=new=#
            stop_aug_epoch_pretrain : 999999         #=new=#
            #
            aug_type            : None              #=検討=#         #'GaussNoise' 'TimeMask'#=new=#
            time_drop_width     : 1000              #=new=#
            time_stripes_num    : 3                 #=new=#
            #other
            random_crop         : True              #=FIX=#
            random_channel      : 'random_in_range_flip_right_left' #'flip_right_left' #=new=#  #'off' or 'random' or 'random_in_range' or 'flip_right_left'
            random_channel_range: [[0,1,2,3], [4,5,6,7], [8,9,10,11], [12,13,14,15]]  #[[0,1,2,3], [4,5,6,7], [8,9,10,11], [12,13,14,15]] #=new=# 
            wave_inverse        : True             #=一旦FIX=#
        mixup                   :
            prob                : -1                #=一旦FIX=#
            alpha               : 0.5               #=一旦FIX=#
            stop_mixup_epoch    : 999999            #=new=#
            #pretrain
            prob_pretrain       : -1                #=new=#
            alpha_pretrain      : 0.5               #=new=#
            stop_mixup_epoch_pretrain: 999999       #=new=#
        time_cutmix             :
            prob                : 0.5                #=一旦FIX=#
            alpha               : 1.0               #=一旦FIX=#
            stop_cutmix_epoch   : 999999            #=new=#
            mode_start0         : False             #=new=#
            #pretrain
            prob_pretrain       : 0.5             #=new=#
            alpha_pretrain      : 1.0               #=new=#
            stop_mixup_epoch_pretrain: 999999       #=new=#
    #=EEG_IMG=#
    EEG_IMG                     :
        dataset_mode            : 'pass'            #=change=#  #'load','calc','pass','save'
        dataset_load_EXP_ID     : 'exp540_EEG_IMG_stft_512_24_16ch_effb0ns_maxxvit_Fold_THv2_add_aug_ALLData'            #'exp244_EEG_IMG_stft_effb0ns_mix0510_cut02510_tfdropFlip_randch_addfeat_GKFold_randselect_patient_eeg'            #=change=#  'None'    
        img_select              : 'img1'            #=change#  #'img1_img4' or 'img4' or 'img1'
        add_eeg_img_feat        : 'none'            #=FIX=# # 'add_4area_ave'   #=new=#    #'none'  'add_4area_ave','only_4area_ave'
        img_size                : [-1,-1]           #=検討=#   # #[384,384]# None
        select_time2_img        :
            calc_select_time2_img: True       
            use_time_ave_img    :  True
            weights_time_img    : [0.05,0.2,0.5,0.2,0.05]   
        augmentation            : 
            prob                    : 0.5           #=FIX=#
            stop_aug_epoch          : 999999        #=new=#
            #pretrain
            prob_pretrain           : 0.5           #=new=#
            stop_aug_epoch_pretrain : 999999        #=new=#
            #
            aug_type            : 'time_freq_drop_HorizontalFlip' #'time_freq_drop_HorizontalFlip' #=検討=#  #'time_freq_drop'　'time_freq_drop_HorizontalFlip''tf_drop_HFlip_blur' #=new=# 
            #time_freq_drop
            time_drop_width     : 6                #=検討=# 
            time_stripes_num    : 2                #=検討=#
            freq_drop_width     : 1                #=検討=#
            freq_stripes_num    : 0                #=検討=#
            #other
            random_crop         : True              #=FIX=#
            random_channel      : 'random_in_range_flip_right_left'             #=new=#   #'random_in_range_flip_right_left' #'off' or 'random' or 'random_in_range'
            random_channel_range: [[0,1,2,3], [4,5,6,7], [8,9,10,11], [12,13,14,15]] #[[0,1,2,3,4,5], [6,7,8,9,10,11], [12,13,14,15,16,17], [18,19,20,21,22,23]] #[[0,1,2,3], [4,5,6,7], [8,9,10,11], [12,13,14,15], [16,17], [18,19], [20,21], [22,23]] #=FIX=#
        IMG1_stft               : 
            calc_img1_stft      : True             #=検討=# 
            N_fft_eeg           : 512              #=一旦FIX=#     # def 400 ホスト提供のspecの設定1000=0.2[Hz]毎の周波数取得。1000*0.005=5[s]間の特徴取得
            hop_eeg             : 24                #=一旦FIX=#     #def 40 ホスト提供のspecの設定400=2[s]ごと
            max_freq            : 40                #=FIX=#
            max                 : 7                 #=一旦FIX=#
            min                 : -6.5              #=一旦FIX=#
            clip_coeff          : 1                 #=一旦FIX=#
        mixup                   :
            prob                : 0.5 #0.5          #=検討=# 
            alpha               : 1.0               #=検討=# 
            stop_mixup_epoch    : 999999            #=FIX=#
            #pretrain
            prob_pretrain       : 0.5               #=new=#
            alpha_pretrain      : 1.0               #=new=#
            stop_mixup_epoch_pretrain: 999999       #=new=#
        time_cutmix             :
            prob                : 0.25 #0.25        #=一旦FIX=#
            alpha               : 1.0               #=一旦FIX=#
            stop_cutmix_epoch   : 999999            #=FIX=#
            #pretrain
            prob_pretrain       : 0.25              #=new=#
            alpha_pretrain      : 1.0               #=new=#
            stop_mixup_epoch_pretrain: 999999             #=new=#
    #=ALL=#
    ALL                             : 
        augmentation                : 
            prob                    : 0.5              #=FIX=#
            stop_aug_epoch          : 9999              #=new=# 
            #pretrain
            prob_pretrain           : 0.5               #=new=#
            stop_aug_epoch_pretrain : 999999            #=new=#
        mixup                       :
            prob                    : 0.5 #0.5          #=検討=# 
            alpha                   : 1.0               #=検討=# 
            stop_mixup_epoch        : 9999             
            #pretrain
            prob_pretrain           : 0.5              
            alpha_pretrain          : 1.0               
            stop_mixup_epoch_pretrain: 9999             
        time_cutmix                 :
            prob                    : 0.25  
            alpha                   : 1.0              
            stop_cutmix_epoch       : 9999            
            #pretrain
            prob_pretrain           : 0.25              
            alpha_pretrain          : 1.0               
            stop_mixup_epoch_pretrain: 9999             
#=model=#
model                                       :
    model_type                              : 'WAVE_CNN'           #'CNN' or'WAVE_CNN' or'MULTI'
    #===SPEC===#
    CNN_SPEC                                :
        #===setting===#
        ch_mode                             : "1ch"              
        feature_extract                     : None                
        backbone_name_cnn                   : 'tf_efficientnet_b0_ns'
        decoder                             : 'pass'                
        decoder_outclass                    : 16 #6                
        ch_head                             : "cnn2d"              
        #===decoder===#
        none_decoder                        : 
        pooling_mlp                         :
            Global_pooling                  : 'max_ave'           
            hidden_mlp                      : 512                
            dropout_mlp                     : 0.0                 
        #===channel head===#
        cnn2d_head_ch                       :
            backbone_name_head_ch           : 'maxxvitv2_nano_rw_256'        
            mode_img_pooling                : "avg"              
            hidden_cnn2d_head_ch            : 512                 
            dropout_cnn2d_head_ch           : 0.0                
    #===EEG_IMG===#
    CNN_EEG                                 :
        #===setting===#
        ch_mode                             : "1ch"              
        feature_extract                     : None                
        backbone_name_cnn                   : 'tf_efficientnet_b0_ns'         #=new=# #'seresnext26t_32x4d' ,"resnet34d",'efficientnet_b0','tf_efficientnet_b0_ns'
        decoder                             : 'pass'   #'none'              #=検討=#        # 'none' #'none','pooling_mlp','sed_type2'
        decoder_outclass                    : 6                   #=new=# #backbone+decoderの出力クラス数
        ch_head                             : "cnn2d" #"cnn2d"               #=new=# # "mlp" 'transformer' 'gnn' 'mlp_2step'
        #===decoder===#
        none_decoder                        : 
        pooling_mlp                         :
            Global_pooling                  : 'ave'           #=new=# #'max_ave','max','ave',
            hidden_mlp                      : 256                 #=new=#
            dropout_mlp                     : 0.0                 #=new=#
        #===channel head===#
        mlp_head_ch                         :
            hidden_mlphead_ch               : 512 # 256           #=一旦 FIX=#
            dropout_mlphead_ch              : 0.0                 #=一旦 FIX=#
            #=add_feat=# 
            mode_add_feat                   : False               #=new=#
        cnn2d_head_ch                       :
            backbone_name_head_ch           : 'maxxvitv2_nano_rw_256'         #=一旦 No Use=#  #'seresnext26t_32x4d' ,"resnet34d",'efficientnet_b0'
            mode_img_pooling                : "avg"               #=一旦 No Use=#  #'max' or 'avg' or "max_avg": "max_min"  
            hidden_cnn2d_head_ch            : 512                 #=一旦 No Use=#   
            dropout_cnn2d_head_ch           : 0.0                 #=一旦 No Use=#
    #===EEG_WAVE===#　
    WAVE_EEG_CNN                            :
        ch_mode                             : "1ch"               #=FIX=# #"4ch" or "1ch"
        #setting
        feature_extract                     : 'multi_1dcnn' #'multi_1dcnn'   #=FIX=# # None ,'multi_1dcnn'
        encoder                             : 'deep_1dcnn'    #=一旦 Fix=# #'deep_1dcnn' or 'stft'
        decoder                             : 'none'              # 'pooling_gru' 'pooling' or 'gru' or'time_att' or 'cnn_pooling' or 'pooling2cnn'
        ch_head                             : "cnn2d"             # "mlp" 'transformer' 'gnn',"cnn2d"
        epoch_change_decoder                : 999999              #=No Use=#  #pretrain終了
        #==feature_extract==
        multi_1dcnn                         : 
            multi_channels                  : [4, 4, 4, 4] #[1, 1, 1, 1]        #=一旦 No Use=# #[1, 1, 1,  1,  1,  1,  1,  1] #[64,128,256,512,256,128,64]
            multi_kernel_sizes              : [5,9,13, 19] #[5,7,9, 11]      #=一旦 No Use=# #[5, 9, 13, 19, 31, 43,59,71]
            multi_strides                   : [1,1,1, 1,] #[1,1,1, 1]          #=一旦 No Use=# #[1, 1, 1 , 1,  1 , 1  ,1  ,1]
            res_depth                       : 3                   #=一旦 No Use=# 
            se_ratio                        : 1                   #=一旦 No Use=# 
            res_kernel_size                 : 4                   #=一旦 No Use=#
        #==encoder==
        deep_1dcnn                          : 
            down_channels                   : [32,64,64] #[64] #[32,64,64,64,32] #=一旦 Fix=# #[16,32,64,64,32,16] # [32,64,64,64,32]# [32,64,64,64,32]
            down_kernel_size                : [3, 3 ,3] #[12] #[8, 5, 5, 5, 5]    #=一旦 Fix=# #[8, 4, 4, 4, 4,4]]# [8, 5, 5, 5, 5] # [3, 3, 3, 3, 3]
            down_stride                     : [2, 2, 2] #[8] #[3, 3, 3, 3, 3]   #=一旦 Fix=## [4, 2, 2, 2, 2,2]  # [3, 3, 3, 3, 3] # [3, 3, 3, 3, 3]
            res_depth                       : 3                   #=一旦 Fix=# # 3
            se_ratio                        : 4                   #=一旦 Fix=# # 4
            res_kernel_size                 : 4                   #=一旦 Fix=# # 4
        #==decoder==
        pooling                             : 
            mode_time_pooling               : "max"               #=一旦 FIX=#   #'max' or 'avg' or "max_avg": "max_min"
            mode_ch_pooling                 : "off"               #=FIX=#       #'off' 'max' or 'avg' or "max_avg": "max_min" or 'off'
        cnn2d_head_ch                       :
            backbone_name_head_ch           : 'maxxvitv2_nano_rw_256' #'maxxvitv2_nano_rw_256'         #=一旦 No Use=#  #'seresnext26t_32x4d' ,"resnet34d",'efficientnet_b0'
            mode_img_pooling                : "avg"               #=一旦 No Use=#  #'max' or 'avg' or "max_avg": "max_min"  
            hidden_cnn2d_head_ch            : 64                  #=一旦 No Use=#   
            dropout_cnn2d_head_ch           : 0.0                 #=一旦 No Use=#
    #===MULTI===#
    MULTI                                   :
        #==setteing==#
        calc_spec                           : True                 #=FIX=#
        calc_eeg_wave                       : True                 #=FIX=#
        calc_eeg_img                        : True                 #=FIX=#
        mode_load_multi_model               : True                 #=FIX=#
        output_type                         : 'logits_output'      #'encoder_output','decoder_output','logits_output'
        output_chans                        : 6                    #=FIX=#
        multi_output                        : False
        multi_output_loss_weight            : [1,0.33,0.33,0.33]
        load_exp_id                         :
            exp_id_spec                     : "exp340_SPEC_effb0ns_maxxvit_Fold_THv2_ALLData"
            exp_id_eeg_wave                 : "exp460_EEG_WAVE_multi1D_deep1D_cnn2D_Fold_THv2_ALLData"
            exp_id_eeg_img                  : "exp550_EEG_IMG_stft_512_24_16ch_effb0ns_maxxvit_Fold_THv2_add_aug_ALLData"
        #==logits_output==#
        logits_output                       :
            head                            : "mlp"               # "mlp" 'transformer' 'gnn'
            mlp_head                        :
                in_chans_head               : 18                  #spec:6 + wave:6 + img:6                 #=一旦 FIX=#       
                hidden_mlphead              : 128                 #=一旦 FIX=#   
                dropout_mlphead             : 0.0                 #=FIX=#    #===LOAD===#
                #=multi_output=# 
                in_chans_head_spec          : 6                 #=一旦 FIX=#
                in_chans_head_wave          : 6                 #=一旦 FIX=#
                in_chans_head_img           : 6                 #=一旦 FIX=#
                hidden_mlphead_spec         : 64                  #=一旦 FIX=#
                hidden_mlphead_wave         : 64                  #=一旦 FIX=#
                hidden_mlphead_img          : 64                  #=一旦 FIX=#
                dropout_mlphead_spec        : 0.0                 #=一旦 FIX=#
                dropout_mlphead_wave        : 0.0                 #=一旦 FIX=#
                dropout_mlphead_img         : 0.0                 #=一旦 FIX=#
                #=add_feat=#         
                mode_add_feat               : False                #=一旦 No Use=#  
    LOAD    :
        exp_id_load                         : "exp970_MULTI_exp340_460_550_logits_out_Fold_THv2_ALLData"
#=train=#
train:
    SEED                            : 411        
    #=Trainer=#
    EPOCHS                          : -1        
    EPOCHS_SETTING                  :           
        SPEC                        : 50         
        EEG_WAVE                    : 10        
        EEG_IMG                     : 50          
        ALL                         : 25         
        SPEC_pretrain               : 50          
        EEG_WAVE_pretrain           : 30          
        EEG_IMG_pretrain            : 50         
        ALL_pretrain                : 30         
    BATCH_SIZE_Tr                   : -1         
    BATCH_SIZE_Val                  : -1         
    BATCH_SIZE_SETTING              :
        SPEC                        : 32          
        EEG_WAVE                    : 16          
        EEG_IMG                     : 20           
        ALL                         : 16           
    DEVICE                          : 'cuda'       
    #=Loader=#
    NUM_WORKERS                     : 4            
    #=optimizer=#
    OPTIMIZER                       :
        #SPEC
        LEARNING_RATE_SPEC              : 0.001             
        LEARNING_RATE_SPEC_pretrain     : 0.0003         
        WEIGHT_DECAY_SPEC               : 0.000000000225
        #EEG_WAVE
        LEARNING_RATE_EEG_WAVE          : 0.001            
        LEARNING_RATE_EEG_WAVE_pretrain : 0.0001            
        WEIGHT_DECAY_EEG_WAVE           : 0.000000001
        #EEG_IMG
        LEARNING_RATE_EEG_IMG           : 0.001        
        LEARNING_RATE_EEG_IMG_pretrain  : 0.0003        
        WEIGHT_DECAY_EEG_IMG            : 0.000000000225
        #ALL
        LEARNING_RATE_ALL               : 0.0005
        LEARNING_RATE_ALL_pretrain      : 0.0002
        WEIGHT_DECAY_ALL                : 0.000000000225
    #=scheduler=#
    SCHEDULER                       :
        scheduler_name              : 'cosine_schedule_with_warmup' 
        num_warmup_steps            : 0                            

#=path=#
path                :
    Env             : "local"
    input_dir       : "./data/input"
    data_dir        : "./data/input/hms-harmful-brain-activity-classification"
    output_dir      : "./data/output"
    LOGGER_dir      : "./logs"
    src_dir         : "./src"
    load_model_dir  : "./data/output/model"


